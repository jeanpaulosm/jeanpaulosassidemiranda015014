# =============================================================================
# PSS Backend MT - Configuracao de Testes
# Processo Seletivo Simplificado - Estado de Mato Grosso 2026
# Candidato: Jean Paulo Sassi de Miranda
# =============================================================================

# =============================================================================
# DATABASE - PostgreSQL via Quarkus DevServices
# =============================================================================
# O Quarkus DevServices inicia automaticamente um container PostgreSQL para testes
# Nao e necessario ter um banco de dados local instalado
quarkus.datasource.db-kind=postgresql
quarkus.datasource.devservices.enabled=true
quarkus.datasource.devservices.image-name=postgres:16-alpine
quarkus.datasource.devservices.port=0

# Hibernate
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=false

# Flyway - executar migrations automaticamente nos testes
quarkus.flyway.migrate-at-start=true
quarkus.flyway.clean-at-start=true

# =============================================================================
# SECURITY - JWT
# =============================================================================
mp.jwt.verify.publickey.location=publicKey.pem
mp.jwt.verify.issuer=https://pss-backend-mt.seplag.mt.gov.br
smallrye.jwt.sign.key.location=privateKey.pem
smallrye.jwt.new-token.lifespan=300
smallrye.jwt.new-token.issuer=https://pss-backend-mt.seplag.mt.gov.br

# =============================================================================
# MinIO/S3 - Mock para testes
# =============================================================================
# Desabilita S3 real nos testes - sera mockado
quarkus.s3.devservices.enabled=false
app.storage.bucket-name=test-bucket
app.storage.presigned-url-expiration-minutes=30

# =============================================================================
# Rate Limit - Configuracao para testes (conforme edital: 10 req/min)
# =============================================================================
app.rate-limit.max-requests=10
app.rate-limit.window-seconds=60

# =============================================================================
# External API - Regionais (sera mockado nos testes)
# =============================================================================
quarkus.rest-client."br.gov.mt.seplag.infrastructure.client.RegionaisClient".url=https://integrador-argus-api.geia.vip

# =============================================================================
# Logging - Reduzir verbosidade nos testes
# =============================================================================
quarkus.log.level=WARN
quarkus.log.category."br.gov.mt.seplag".level=INFO
quarkus.log.category."io.quarkus.test".level=WARN

# =============================================================================
# WebSocket
# =============================================================================
quarkus.websocket.dispatch-to-worker=true

# =============================================================================
# Health Check - Desabilitar nos testes unitarios
# =============================================================================
quarkus.smallrye-health.extensions.enabled=false
